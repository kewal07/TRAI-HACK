{% extends "trai_complaint/common.html" %}
{% load custom_tags %}
{% block extra_css %}
	<style>
    	.content-wrapper, .right-side, .main-footer{
			margin-left: 235px;
		}
		.skin-blue .wrapper, .skin-blue .main-sidebar, .skin-blue .left-side{
			background-color:#222d32; 
		}
    </style>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> 
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
{% endblock %}
{% block content %}
	<!-- Left side column. contains the logo and sidebar -->
	<aside class="main-sidebar">
	<!-- sidebar: style can be found in sidebar.less -->
		<section class="sidebar">
		  <!-- /.search form -->
		  <!-- sidebar menu: : style can be found in sidebar.less -->
		  <ul class="sidebar-menu">
		    <li class="header">MAIN NAVIGATION</li>
		    <li class="active">
		      <a href="#">
		        <i class="fa fa-dashboard"></i> <span>Dashboard</span>
		      </a>
		    </li>
		    <li>
		      <a href="{% url 'trai_complaint:comparative' %}">
		        <i class="fa fa-pie-chart"></i> <span>Comparitive Analytics</span>
		      </a>
		    </li>
		    <li>
		      <a href="{% url 'trai_complaint:predective' %}">
		        <i class="fa fa-bars"></i> <span>Predective Analytics</span>
		      </a>
		    </li>
		    <li>
		      <a href="{% url 'trai_complaint:download' %}">
		        <i class="fa fa-cloud-download"></i> <span>View & Export</span>
		      </a>
		    </li>
		  </ul>
		</section>
	<!-- /.sidebar -->
	</aside>
	<!-- Content Wrapper. Contains page content -->
	<div class="content-wrapper">
	<!-- Content Header (Page header) -->
		<section class="content-header">
		  <h1>
		    Dashboard
		    <small>Control panel</small>
		  </h1>
		  <ol class="breadcrumb">
		    <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
		    <li class="active">Dashboard</li>
		  </ol>
		</section>
		<!-- Main content -->
		<section class="content">
			<!-- Small boxes (Stat box) -->
			<div class="row">
				<div class="col-lg-3 col-xs-6">
				    <!-- small box -->
				    <div class="small-box bg-aqua">
				        <div class="inner">
				          <h3>{{ data.complaints|length }}</h3>

				          <p>Total Issues</p>
				        </div>
				        <div class="icon">
				          <i class="ion ion-bag"></i>
				        </div>
				        <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
				    </div>
				</div>
				<!-- ./col -->
				<div class="col-lg-3 col-xs-6">
				    <!-- small box -->
				    <div class="small-box bg-green">
				        <div class="inner">
				          <h3>{{ data.openc|length }}</h3>

				          <p>Open Issues</p>
				        </div>
				        <div class="icon">
				          <i class="ion ion-stats-bars"></i>
				        </div>
				        <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
				    </div>
				</div>
				<!-- ./col -->
				<div class="col-lg-3 col-xs-6">
				    <!-- small box -->
				    <div class="small-box bg-yellow">
				        <div class="inner">
				          <h3>15%</h3>

				          <p>Monthly Increase In Complaints</p>
				        </div>
				        <div class="icon">
				          <i class="ion ion-arrow-graph-up-right"></i>
				        </div>
				        <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
				    </div>
				</div>
				<!-- ./col -->
				<div class="col-lg-3 col-xs-6">
				    <!-- small box -->
				    <div class="small-box bg-red">
				        <div class="inner">
				          <h3>65000</h3>

				          <p>Unique Monthly Visitors</p>
				        </div>
				        <div class="icon">
				          <i class="ion ion-person-add"></i>
				        </div>
				        <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
				    </div>
				</div>
				<!-- ./col -->
			</div>
			<!-- /.row -->
			<!-- Main row -->
			<div class="row">
				<section class="col-md-12">
				    <!-- Custom tabs (Charts with tabs)-->
				    <div class="nav-tabs-custom">
				        <!-- Tabs within a box -->
				        <ul class="nav nav-tabs pull-right">
				          <li class="active"><a href="#" data-toggle="tab">Area</a></li>
				          <!-- <li><a href="#sales-chart" data-toggle="tab">Donut</a></li> -->
				          <li class="pull-left header"><i class="fa fa-line-chart"></i> Trend</li>
				        </ul>
				        <div class="tab-content no-padding">
				          <!-- Morris chart - Sales -->
				          <div class="chart tab-pane active" id="trend-chart" style="position: relative; height: 300px;"></div>
				        </div>
				    </div>
				</section>
				<section class="col-md-12">
				   	<div class="row">
				   		<div class="col-md-6">
				   			<div id="geochart-colors"></div>
						</div>
						<div class="col-md-6">
					        <div class="box">
					            <div class="box-header with-border">
					              	<h3 class="box-title">TSP Breakdown</h3>
					            </div>
						        <!-- /.box-header -->
						        <div class="box-body tsp-table-body">
						            <table id="tsp-breakdown" class="table table-bordered">
						                <tr>
						                  <th style="width: 10px">#</th>
						                  <th>TSP</th>
						                  <th>Status</th>
						                  <th style="width: 40px"># Issues</th>
						                  <th style="width: 40px">% Solved</th>
						                </tr>
						                <tr>
						                  <td>1.</td>
						                  <td>Airtel</td>
						                  <td>
						                    <div class="progress progress-xs">
						                      <div class="progress-bar progress-bar-danger" style="width: 55%"></div>
						                    </div>
						                  </td>
						                  <td><span class="badge bg-red">22000</span></td>
						                  <td><span class="badge bg-red">55%</span></td>
						                </tr>
						                <tr>
						                  <td>2.</td>
						                  <td>BSNL</td>
						                  <td>
						                    <div class="progress progress-xs">
						                      <div class="progress-bar progress-bar-yellow" style="width: 70%"></div>
						                    </div>
						                  </td>
						                  <td><span class="badge bg-red">22000</span></td>
						                  <td><span class="badge bg-yellow">70%</span></td>
						                </tr>
						                <tr>
						                  <td>3.</td>
						                  <td>Reliance</td>
						                  <td>
						                    <div class="progress progress-xs progress-striped active">
						                      <div class="progress-bar progress-bar-primary" style="width: 30%"></div>
						                    </div>
						                  </td>
						                  <td><span class="badge bg-red">22000</span></td>
						                  <td><span class="badge bg-light-blue">30%</span></td>
						                </tr>
						                <tr>
						                  <td>4.</td>
						                  <td>Vodafone</td>
						                  <td>
						                    <div class="progress progress-xs progress-striped active">
						                      <div class="progress-bar progress-bar-success" style="width: 90%"></div>
						                    </div>
						                  </td>
						                  <td><span class="badge bg-red">22000</span></td>
						                  <td><span class="badge bg-green">90%</span></td>
						                </tr>
						                <tr>
						                  <td>5.</td>
						                  <td>Tata Docomo</td>
						                  <td>
						                    <div class="progress progress-xs progress-striped active">
						                      <div class="progress-bar progress-bar-success" style="width: 90%"></div>
						                    </div>
						                  </td>
						                  <td><span class="badge bg-red">22000</span></td>
						                  <td><span class="badge bg-green">90%</span></td>
						                </tr>
						            </table>
						        </div>
					           	<!-- /.box-body -->
					        </div>
					        <!-- /.box -->
					    </div>
				   	</div>
				   	<div class="row">
				   		<div class="col-md-12">
				   			<div class="box box-info">
					            <div class="box-header with-border">
					              <h3 class="box-title">Issues View</h3>
					            </div>
            					<!-- /.box-header -->
					            <div class="box-body">
					              <div class="table-responsive">
					                <table class="table no-margin">
					                  <thead>
					                  <tr>
					                    <th>SR NO</th>
					                    <th>Circle Name</th>
					                    <th>Product Type</th>
					                    <th>TSP</th>
					                    <th>Summary</th>
					                    <th>Created On</th>
					                    <th>Last Updated On</th>
					                    <th>Status</th>
					                  </tr>
					                  </thead>
					                  <tbody>
					                  	{% for complaint in data.complaints %}
					                  		<tr>
							                    <td><a href="{% url 'trai_complaint:complaint-detail' complaint.id complaint.slug %}">{{ complaint.id }}</a></td>
							                    <td>{{ complaint.circle }}</td>
							                    <td>
							                    	{% for cmp in complaint.complaintwithservice_set.all %}
									              		{{ cmp.service.display_name }}</t>
									              	{% endfor %}
									            </td>
							                    <td>{{ complaint.tsp.display_name }}</td>
							                    <td>{{ complaint.summary }}</td>
							                    <td>{{ complaint.created_at }}</td>
							                    <td>{{ complaint.updated_at }}</td>
							                    <td><span class="label {{ complaint.status.code|get_status_state }}">{{ complaint.status.display_name }}</span></td>
							                  </tr>
					                  	{% endfor %}
					                  </tbody>
					                </table>
					              </div>
					              <!-- /.table-responsive -->
					            </div>
					            <!-- /.box-body -->
					            <div class="box-footer clearfix">
					              <a href="javascript:void(0)" class="btn btn-sm btn-default btn-flat pull-right">View All </a>
					            </div>
					            <!-- /.box-footer -->
          					</div>
		   				</div>
		   			</div>
		    	</section>
		    	<!-- right col -->
		  	</div>
		  	<!-- /.row (main row) -->
		</section>
	<!-- /.content -->
	</div>
{% endblock %}
{% block extra_js %}
	<script src="/static/plugins/morris/morris.min.js"></script>
	<script src="/static/js/dashboard.js"></script>
	<script>
		google.charts.load('current', {'packages':['geochart']});
  		google.charts.setOnLoadCallback(drawRegionsMap);

  		 function drawRegionsMap() {
	        var data = google.visualization.arrayToDataTable([
	          ['State',   'Issues'],
	          ['Punjab', 3600],
	          ['Bihar',3800],
	          ['Karnataka',4000],
	          ['Kerala', 4200],
	          ['Jharkhand',4400],
	          ['West Bengal',4600],
	          ['Orissa', 4800],
	          ['Madhya Pradesh',5000],
	          ['Uttar Pradesh',5200],
	          ['Andhra Pradesh', 5400],
	          ['Arunachal Pradesh',5600],
	          ['Assam',5800],
	          ['Chhattisgarh', 6000],
	          ['Goa',6200],
	          ['Gujrat',6400],
	          ['Haryana', 6600],
	          ['Himachal Pradesh',6800],
	          ['Jammu and Kashmir',7000],
	          ['Maharashtra', 7200],
	          ['Manipur',7400],
	          ['Meghalaya',7600],
	          ['Mizoram', 7800],
	          ['Nagaland',8000],
	          ['Rajasthan',8200],
	          ['Sikkim', 8400],
	          ['Tamil Nadu',8600],
	          ['Uttarakhand',8800],
	          ['Telangana', 9000],
	          ['Tripura',9200],
	          ['Chandigarh',9400]
	        ]);

	        var options = {
	          region: 'IN', // Africa
	          colorAxis: {colors: ['#ff9900', '#ffffff', '#00cc00']},
	          resolution:'provinces',
	          backgroundColor: '#81d4fa',
	          datalessRegionColor: '#f8bbd0',
	          defaultColor: '#f5f5f5',
	          domain:'IN',
	          displayMode:'regions'
	        };

	        var chart = new google.visualization.GeoChart(document.getElementById('geochart-colors'));
	        chart.draw(data, options);
	    };
		$(function () {
			// $("#tsp-breakdown").DataTable();
		   
		});
	</script
{% endblock %}